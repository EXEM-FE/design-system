# Load NVM and set PATH for pnpm (VSCode Source Control compatibility)
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"

# ğŸ”„ í† í° ìë™ ìƒì„± (stylesheet ë³€ê²½ ì‹œ)
if git diff --cached --name-only | grep -q "packages/stylesheet/src/global.css"; then
  echo "ğŸ”„ CSS ë³€ê²½ ê°ì§€ - í† í° ìë™ ìƒì„± ì¤‘..."
  pnpm --filter @exem-fe/design-token generate
  git add packages/design-token/src/tokens/*.ts
  echo "âœ… í† í° ìƒì„± ì™„ë£Œ ë° ìŠ¤í…Œì´ì§• ì¶”ê°€ë¨"
fi

# ğŸ¨ lint-stagedë¡œ ìŠ¤í…Œì´ì§•ëœ íŒŒì¼ë§Œ í¬ë§·íŒ… ë° ë¦°íŒ…
echo "ğŸ¨ Formatting and linting staged files..."
npx lint-staged || {
    echo "âš ï¸  Some lint issues remain (auto-generated files ignored)"
    exit 0
}

# íƒ€ì… ì²´í¬ ì‹¤í–‰  
echo "ğŸ”§ Type checking..."
pnpm typecheck

echo "âœ… Pre-commit checks passed!"
