# Load NVM and set PATH for pnpm (VSCode Source Control compatibility)
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"

# ğŸ”„ í† í° ìë™ ìƒì„± (stylesheet ë³€ê²½ ì‹œ)
if git diff --cached --name-only | grep -q "packages/stylesheet/src/global.css"; then
  echo "ğŸ”„ CSS ë³€ê²½ ê°ì§€ - í† í° ìë™ ìƒì„± ì¤‘..."
  pnpm --filter exem-design-token generate
  git add packages/design-token/src/tokens/*.ts
  echo "âœ… í† í° ìƒì„± ì™„ë£Œ ë° ìŠ¤í…Œì´ì§• ì¶”ê°€ë¨"
fi

# í¬ë§·íŒ… ë¨¼ì € ì‹¤í–‰
echo "ğŸ¨ Formatting code..."
pnpm format

# í¬ë§·íŒ…ëœ íŒŒì¼ë“¤ ë‹¤ì‹œ ìŠ¤í…Œì´ì§•
git add .

# ë¦°íŒ… ì‹¤í–‰ (Biomeì´ ìë™ìœ¼ë¡œ dist í´ë” ë¬´ì‹œ)
echo "ğŸ” Linting code..."
pnpm lint:fix || {
    echo "âš ï¸  Some lint issues remain (auto-generated files ignored)"
    exit 0
}

# íƒ€ì… ì²´í¬ ì‹¤í–‰  
echo "ğŸ”§ Type checking..."
pnpm typecheck

echo "âœ… Pre-commit checks passed!"
